
  <code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br /></span><span style="color: #007700">include(</span><span style="color: #DD0000">'config.php'</span><span style="color: #007700">);<br /><br />include(</span><span style="color: #DD0000">'flag.php'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">highlight_file</span><span style="color: #007700">(</span><span style="color: #DD0000">'index.php'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$blacklist&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'/_|\.|\(\)|=|\||_|&lt;|&gt;|sqlauth|_|\.|\(\)|and|if|database|where|concat|insert|having|limit|mid|substr|by|mid|not|ascii|char|greatest|benchmark|%00|sleep/i'</span><span style="color: #007700">;<br /><br />if(</span><span style="color: #0000BB">preg_match</span><span style="color: #007700">(</span><span style="color: #0000BB">$blacklist</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">'pass'</span><span style="color: #007700">]))&nbsp;exit(</span><span style="color: #DD0000">"No&nbsp;Hack&nbsp;~_~"</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$a&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">'pass'</span><span style="color: #007700">];<br /><br /></span><span style="color: #0000BB">$rp&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">"union"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"like"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"select"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"hostname"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"admin"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"char"</span><span style="color: #007700">);<br /><br />for&nbsp;(</span><span style="color: #0000BB">$i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">6</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++)<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$a&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">str_ireplace</span><span style="color: #007700">(</span><span style="color: #0000BB">$rp</span><span style="color: #007700">[</span><span style="color: #0000BB">$i</span><span style="color: #007700">],&nbsp;</span><span style="color: #DD0000">''</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$a</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #0000BB">$sql&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"select&nbsp;name&nbsp;from&nbsp;users&nbsp;where&nbsp;name='guest'&nbsp;and&nbsp;id='</span><span style="color: #0000BB">$a</span><span style="color: #DD0000">'"</span><span style="color: #007700">;<br /><br /><br /></span><span style="color: #0000BB">$result&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mysqli_fetch_array</span><span style="color: #007700">(</span><span style="color: #0000BB">mysqli_query</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$sql</span><span style="color: #007700">));<br /><br />echo&nbsp;(</span><span style="color: #DD0000">"&lt;br&gt;"</span><span style="color: #007700">.</span><span style="color: #0000BB">mysqli_error</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">));<br /><br />echo&nbsp;</span><span style="color: #0000BB">$sql</span><span style="color: #007700">.</span><span style="color: #DD0000">"&lt;br&gt;"</span><span style="color: #007700">;<br /><br />echo&nbsp;</span><span style="color: #0000BB">$result</span><span style="color: #007700">[</span><span style="color: #DD0000">'name'</span><span style="color: #007700">].</span><span style="color: #DD0000">"&lt;br&gt;"</span><span style="color: #007700">;<br /><br />if(</span><span style="color: #0000BB">$result</span><span style="color: #007700">[</span><span style="color: #DD0000">'name'</span><span style="color: #007700">]===</span><span style="color: #DD0000">'admin'</span><span style="color: #007700">)<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">$flag</span><span style="color: #007700">;<br />}&nbsp;<br />else&nbsp;<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Try&nbsp;hard"</span><span style="color: #007700">;<br />}<br />&nbsp;<br /><br /></span><span style="color: #0000BB">?&gt;<br /></span>
</span>
</code><br>select name from users where name='guest' and id=''<br><br>Try hard