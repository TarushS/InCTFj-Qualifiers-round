
<h2>query : select user from sqlauth where user='guest' and pw=''</h2><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php
<br />error_reporting</span><span style="color: #007700">(</span><span style="color: #0000BB">0</span><span style="color: #007700">);
<br />include&nbsp;</span><span style="color: #DD0000">"./config.php"</span><span style="color: #007700">;
<br />include&nbsp;</span><span style="color: #DD0000">"./flag.php"</span><span style="color: #007700">;
<br />
<br /></span><span style="color: #0000BB">$black_list&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"/admin|guest|limit|by|substr|mid|or|not|ascii|char|union|select|greatest|%00|\"|benchmark|"</span><span style="color: #007700">;
<br /></span><span style="color: #0000BB">$black_list&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">"=|_|in|&lt;|&gt;|sqlauth|_|\.|\(\)|and|if|database|where|concat|insert|having|sleep/i"</span><span style="color: #007700">;
<br />
<br />if(</span><span style="color: #0000BB">preg_match</span><span style="color: #007700">(</span><span style="color: #0000BB">$black_list</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">'pass'</span><span style="color: #007700">]))&nbsp;exit(</span><span style="color: #DD0000">":P"</span><span style="color: #007700">);
<br />
<br /></span><span style="color: #0000BB">$query&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"select&nbsp;user&nbsp;from&nbsp;sqlauth&nbsp;where&nbsp;user='guest'&nbsp;and&nbsp;pw='</span><span style="color: #007700">{</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #0000BB">pass</span><span style="color: #007700">]}</span><span style="color: #DD0000">'"</span><span style="color: #007700">;
<br />echo&nbsp;</span><span style="color: #DD0000">"&lt;h2&gt;query&nbsp;:&nbsp;</span><span style="color: #007700">{</span><span style="color: #0000BB">$query</span><span style="color: #007700">}</span><span style="color: #DD0000">&lt;/h2&gt;"</span><span style="color: #007700">;
<br /></span><span style="color: #0000BB">$result&nbsp;</span><span style="color: #007700">=&nbsp;@</span><span style="color: #0000BB">mysqli_fetch_array</span><span style="color: #007700">(</span><span style="color: #0000BB">mysqli_query</span><span style="color: #007700">(</span><span style="color: #0000BB">$con</span><span style="color: #007700">,</span><span style="color: #0000BB">$query</span><span style="color: #007700">));
<br /></span><span style="color: #0000BB">$admin_info&nbsp;</span><span style="color: #007700">=&nbsp;&nbsp;@</span><span style="color: #0000BB">mysqli_fetch_array</span><span style="color: #007700">(</span><span style="color: #0000BB">mysqli_query</span><span style="color: #007700">(</span><span style="color: #0000BB">$con</span><span style="color: #007700">,</span><span style="color: #DD0000">'select&nbsp;*&nbsp;from&nbsp;sqlauth&nbsp;where&nbsp;user="admin"'</span><span style="color: #007700">));
<br />
<br />if(</span><span style="color: #0000BB">$result</span><span style="color: #007700">[</span><span style="color: #DD0000">'user'</span><span style="color: #007700">])&nbsp;echo&nbsp;</span><span style="color: #DD0000">"&lt;h2&gt;Welcome&nbsp;</span><span style="color: #007700">{</span><span style="color: #0000BB">$result</span><span style="color: #007700">[</span><span style="color: #0000BB">user</span><span style="color: #007700">]}</span><span style="color: #DD0000">&lt;/h2&gt;"</span><span style="color: #007700">;
<br />
<br />if((</span><span style="color: #0000BB">$admin_info</span><span style="color: #007700">[</span><span style="color: #DD0000">'pw'</span><span style="color: #007700">])&amp;&amp;&nbsp;</span><span style="color: #0000BB">$admin_info</span><span style="color: #007700">[</span><span style="color: #DD0000">'user'</span><span style="color: #007700">]===</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">'user'</span><span style="color: #007700">]&nbsp;&amp;&amp;&nbsp;</span><span style="color: #0000BB">$admin_info</span><span style="color: #007700">[</span><span style="color: #DD0000">'pw'</span><span style="color: #007700">]===</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">'pass'</span><span style="color: #007700">])
<br />{
<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">$flag</span><span style="color: #007700">;
<br />}
<br />
<br /></span><span style="color: #0000BB">highlight_file</span><span style="color: #007700">(</span><span style="color: #0000BB">__FILE__</span><span style="color: #007700">);
<br /></span><span style="color: #0000BB">?&gt;
<br /></span>
</span>
</code>